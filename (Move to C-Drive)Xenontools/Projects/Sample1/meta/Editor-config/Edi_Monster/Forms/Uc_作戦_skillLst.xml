<?xml version="1.0" encoding="Shift_JIS" ?>
                                    <!-- ↓このバージョン番号の説明は
                                           Aa_Editor.xml参照 -->
<codefile-controls codefile-version="2.0">


    <!--
      このコントロールの紹介
    ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
        ■
      ■■■ スキル番号選択リストボックス
        ■
                                        [記号] Uc:作戦_skillLst;
                                        [種類] リストボックス（C:Lst;）
                                        [画面] メイン画面
                                                        （Ufo:スキル;）
                                                    （Forms/Ufo_スキ.csv）

                モンスターの所持スキルを選ばせます。
                ※IDではなく、スロット番号。

    ├──────────────────────────────────┤
      【その他の機能】
                                ・項目をダブルクリックすると、選択と同時に
                                  ウィンドウを閉じる。
                                  
                                ・選んだレコードの「ID」フィールド値を変数
                                  に格納する。
    ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
    -->
    <control>


        <!--
          データの設定
        ┌──────────────────────────────────┐
            ■■
          ■  ■ データ読取元
            ■■
                    スキルリストIDテーブル（①）の全レコード。（※①脚注）

          ■■
          ■  ■ データ変更先
          ■■
                    「Us:項目値_スキルリスト;」変数（②※脚注）。

        -->
        <data access="from" memory="records">
            <arg name="Pm:name-table;"  value="Ut:スキルリストID;" /><!-- ① -->
        </data>
        <data access="to" memory="variable">
            <arg name="Pm:name-var;"    value="Us:項目値_スキルリスト;" /><!-- ② -->
        </data>
        <!--
        ├──────────────────────────────────┤
          ※①脚注
              ・このコントロールにレコードがどのように表示されるかは、レイアウ
                ト・テーブルの ITEM_DISPLAY_FORMAT フィールドで設定してくださ
                い。
        ├──────────────────────────────────┤
          ※②脚注
              ・［ＤＡＴＡ］（１／２）で指定しているテーブルの、選択されている
                レコードの ID値 が変数に格納されます。
        └──────────────────────────────────┘
        -->


        <!--
          イベントの設定（１／２）
        ┌──────────────────────────────────┐
            ■
          ■  ■ ウィンドウオープン時（①）。
            ■

              （１）このリストボックス・コントロールに、［データの設定］で指定
                    したテーブルを関連付けます。（※脚注）
                    
              （２）このリストボックス・コントロールに、［ビューの設定］で指定
                    したリストボックスの項目の表示書式を関連付けます。
                    
              （３）［トゥゲザーの設定］に名前が挙がっているコントロールを最新
                    の状態にし、このフォームの整合性を取ります。
        -->
        <event name="Se:読取時;"><!-- ① -->
            <fnc name="Sf:リストボックス_表関連付け;" /><!-- （１） -->
            <fnc name="Sf:ビュー関連付け;" /><!-- （２） -->
            <fnc name="Sf:整合性を取る;" /><!-- （３） -->
        </event>
        <!--
        ├──────────────────────────────────┤
          ※脚注
                これにより、リストボックス・コントロールは、テーブルの内容を表
                示できるようになります。
        └──────────────────────────────────┘
        -->


        <!--
          イベントの設定（２／２）
        ┌──────────────────────────────────┐
            ■
          ■  ■ このコントロールで変更作業をした時（①）。
            ■
            
              （１）［データの設定］で指定したテーブルと関連付けられているこの
                    リストボックス・コントロールで、現在選択しているレコードの
                    「ID」フィールド（②）の値を、「Ui:選択スキルリストID;」変
                    数（③）に格納します。
                    
              （２）［トゥゲザーの設定］に名前が挙がっているコントロールを最新
                    の状態にし、このフォームの整合性を取ります。
        -->
        <event name="Se:項目選択時;"><!-- ① -->
            <fnc name="Sf:変数設定_選択行の列指定;"><!-- （１） -->
                <arg name="Pm:name-field;"  value="ID" /><!-- ② -->
                <arg name="Pm:name-var-destination;"
                                   value="Ui:選択スキルリストID;" /><!-- ③ -->
            </fnc>
            <fnc name="Sf:整合性を取る;" /><!-- （２） -->
        </event>
        <!--
        └──────────────────────────────────┘
        -->


        <!--
          ビューの指定
        ┌──────────────────────────────────┐
          ■■■
          ■  ■ リストボックス型（①）のコントロールの表示書式を設定します。
          ■■■
            
        ・「Sf:ListboxLabels;」関数（②）は、リストボックス・コントロールの
            全ての項目のテキストを表示する機能です。
        ・「Sf:ItemLabel;」関数（③）は、リストボックス・コントロールの項目に
            表示するテキストのテンプレートを作成する機能です。
            
            それではテキストのテンプレートを作成します。
            ・「Us:項目値_スキルリスト;」変数で、スキル番号を取得します。
                「10」「11」といった値が入っています。
                
            ・文字列「:」（⑤）を連結します。
            
            ・⑥は、テーブルのセルの値です。
                「Ut:アイテム;」テーブル（⑦）の「NAME」フィールド（⑧）から値を
                検索します。
                選ぶレコードを決めます（⑨）。
                
                ・「ID」フィールド（⑩）に、見つけたい値（⑪）が入っているレコー
                    ドを選びます。
                    ⑪は、テーブルを検索して見つけた値とします。
                    
                    ⑪の値は、「Ut:敵作戦;」テーブル（⑫）の「SKL*」フィールド
                    （⑬※脚注）の値です。
                    選ぶレコードを決めます（⑭）。
                    
                    ・「ID」フィールド（⑮）に、「Ui:選択モンスターID;」変数（⑯
                        ）の値が入っているレコードを選びます。
        -->
        <view target="listbox"><!-- ① -->
            <fnc name="Sf:ListboxLabels;"><!-- ② -->
                <fnc name="Sf:ItemLabel;"><!-- ③ -->
                    <f-var value="Us:項目値_スキルリスト;" /><!-- ④ -->
                    <f-str value=":" /><!-- ⑤ -->
                    <fnc name="Sf:Cell;"><!-- ⑥ -->
                        <arg name="Pm:select;" value="NAME" /><!-- ⑧ -->
                        <arg name="Pm:from;" value="Ut:アイテム;" /><!-- ⑦ -->
                        <fnc name="Sf:Where;">
                            <!-- ⑨ -->
                            <fnc name="Sf:RecCond;">
                                <arg name="Pm:field;" value="ID" /><!-- ⑩ -->
                                <!-- ⑪ -->
                                <fnc name="Sf:Cell;">
                                    <arg name="Pm:select;"
                                        description="select属性が「SKL10～SK39」">
                                        <!-- ⑬ -->
                                        <f-str value="SKL" />
                                        <f-var value="Us:項目値_スキルリスト;" />
                                    </arg>
                                    <arg name="Pm:from;" value="Ut:敵作戦;" />
                                                                    <!-- ⑫ -->
                                    <fnc name="Sf:Where;">
                                        <!-- ⑭ -->
                                        <fnc name="Sf:RecCond;">
                                            <arg name="Pm:field;" value="ID" />
                                                                    <!-- ⑮ -->
                                            <f-var value="Ui:選択モンスターID;" />
                                                                    <!-- ⑯ -->
                                        </fnc>
                                    </fnc>
                                </fnc>
                            </fnc>
                        </fnc>
                    </fnc>
                </fnc>
            </fnc>
        </view>
       <!--
        ・※⑬脚注
            別の「Uc:作戦_skillLst;」リストボックス・コントロールで項目を選ぶと
            「Ui:選択スキルリストID;」変数の内容が「10」「11」と変わるようにして
            あり、
            そのリストボックスで「10」を選んでいるときは「COND10」フィールド、
            そのリストボックスで「11」を選んでいるときは「COND11」フィールド、
            といったように、
            そのリストボックスで選んでいる項目によってデータを取り出すフィールド
            を変えるために、
                フィールド名の変わらない部分に<f-str>を、
                フィールド名の変わる部分に    <f-var>を使って、
            フィールド名を可変にしています。
        └──────────────────────────────────┘
        -->


        <!--
          トゥゲザーの設定
        ┌──────────────────────────────────┐
              ■
          ■■■  このコントロールで変更作業をした時。
          ■

        -->
                        <!-- ① -->
        <together on="Se:項目選択時;" target="
            Uc:作戦_skillLst;*

            Uc:作戦_SKL00_Label;,
            Uc:作戦_SKL00;,
            Uc:作戦_SKL00_Name;,

            Uc:作戦_LV00;,
            Uc:作戦_OPT00;,

            Uc:作戦_COND00_Explain;,
            Uc:作戦_COND00;,
            Uc:作戦_COND00x;,
            Uc:作戦_COND00y;,
            Uc:作戦_COND00z;,

            Uc:作戦_PRI00;,
            Uc:作戦_USE00;,
            Uc:作戦_PER00_Explain;,
            Uc:作戦_PER00;
            Uc:作戦_PER00a;
        " /> <!-- ② -->
        <!--
        ├──────────────────────────────────┤
          ※説明
              ・［イベントの設定］の「Se:項目選択時;」（①）の中に書かれてある
                「Sf:整合性を取る;」のタイミングで、名前が挙がっているコントロ
                ール（②）を最新の状態にし、このフォームの整合性を取ります。
          ※説明
                リストボックス（＊）は、「更新」をしないと、表示が最新にならな
                いので、処理の重い再読み込みを行う。
        └──────────────────────────────────┘
        -->


    </control>


</codefile-controls>
